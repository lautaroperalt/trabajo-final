<div class="container mt-4 mb-5">
  
  <header class="mb-4">
    <h1 class="fs-2 fw-bold mb-3">Menu del Restaurante</h1>

    <div class="mb-3">
      <div class="input-group">
        <span class="input-group-text bg-white border-end-0">
          <i class="bi bi-search text-muted"></i>
        </span>
        <input type="text" 
               class="form-control border-start-0 ps-0" 
               placeholder="Buscar plato por nombre o descripciÃ³n..."
               [(ngModel)]="searchSearch"
               (input)="productFilter()">
      </div>
    </div>
    
    <section class="d-flex gap-2 flex-wrap">
      <button (click)="filterMenu(undefined, false)" 
              class="btn" 
              [class.btn-primary]="!currentDiscount && currentCategoryId === undefined"
              [class.btn-outline-primary]="currentDiscount || currentCategoryId !== undefined">
        Ver todo
      </button>

      <button (click)="filterMenu(undefined, true)" 
              class="btn" 
              [class.btn-danger]="currentDiscount"
              [class.btn-outline-danger]="!currentDiscount">
        Solo ofertas
      </button>

      @for (cat of categories; track cat.id) {
        <button (click)="filterMenu(cat.id, false)"
                class="btn btn-outline-secondary"
                [class.active]="currentCategoryId === cat.id">
          {{ cat.name }}
        </button>
      }
    </section>
  </header>

  @if (isLoading) {
  <div class="d-flex justify-content-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>
  } @else {
    @if (menu.length === 0) {
      <div class="alert alert-warning text-center">
        No se encontraron productos con estos filtros
      </div>
    } @else {
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        @for (product of menu; track product.id) {
          <div class="col">
            <app-product-card 
                [product]="product" 
                (viewDetail)="openDetail($event)">
            </app-product-card>
          </div>
        }
      </div>
    }
  }
</div>

@if (selectedProduct) {
  <app-product-detail 
      [product]="selectedProduct" 
      (close)="closeDetail()">
  </app-product-detail>
}